<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asynchronous JavaScript Examples</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .section {
            margin-bottom: 30px;
            padding: 10px;
            border: 1px solid #ccc;
        }

        button {
            padding: 10px;
            margin: 5px;
        }

        #output {
            background: #f0f0f0;
            padding: 10px;
            min-height: 50px;
        }
    </style>
</head>

<body>
    <h1>Asynchronous JavaScript Examples</h1>

    <div class="section">
        <h2>1. Timers</h2>
        <button onclick="demoSetTimeout()">setTimeout Example</button>
        <button onclick="demoSetInterval()">setInterval Example</button>
        <button onclick="clearIntervalDemo()">Clear Interval</button>
        <button onclick="explainTimers()">Explain Timers</button>
        <div id="timerOutput"></div>
    </div>

    <div class="section">
        <h2>2. Promises</h2>
        <button onclick="demoPromise()">Basic Promise</button>
        <button onclick="demoPromiseChain()">Promise Chain</button>
        <button onclick="demoPromiseAll()">Promise.all</button>
        <button onclick="explainPromises()">Explain Promises</button>
        <div id="promiseOutput"></div>
    </div>

    <div class="section">
        <h2>3. Async/Await</h2>
        <button onclick="demoAsyncAwait()">Async/Await Example</button>
        <button onclick="explainAsyncAwait()">Explain Async/Await</button>
        <div id="asyncOutput"></div>
    </div>

    <div class="section">
        <h2>4. Fetch API (API Calls)</h2>
        <button onclick="demoFetch()">Fetch JSON Placeholder</button>
        <button onclick="explainFetch()">Explain Fetch API</button>
        <div id="fetchOutput"></div>
    </div>

    <div class="section">
        <h2>5. File Loading</h2>
        <input type="file" id="fileInput" onchange="loadFile()">
        <div id="fileOutput"></div>
        <button onclick="explainFileLoading()">Explain File Loading</button>
    </div>

    <div class="section">
        <h2>6. Callbacks</h2>
        <button onclick="demoCallback()">Callback Example</button>
        <div id="callbackOutput"></div>
        <button onclick="explainCallbacks()">Explain Callbacks</button>
    </div>

    <div class="section">
        <h2>7. Event Listeners</h2>
        <button id="eventButton">Click me for Event</button>
        <div id="eventOutput"></div>
        <button onclick="explainEventListeners()">Explain Event Listeners</button>
    </div>

    <div class="section">
        <h2>8. Web Workers</h2>
        <button onclick="demoWebWorker()">Start Web Worker</button>
        <div id="workerOutput"></div>
        <button onclick="explainWebWorkers()">Explain Web Workers</button>
    </div>

    <div id="output"></div>

    <div id="modal"
        style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); justify-content:center; align-items:center;">
        <div style="background:white; padding:20px; border-radius:5px; max-width:500px;">
            <h3 id="modalTitle"></h3>
            <p id="modalContent"></p>
            <button onclick="closeModal()">Close</button>
        </div>
    </div>

    <script>
        let intervalId;

        // Timers
        function demoSetTimeout() {
            document.getElementById('timerOutput').innerHTML = 'Waiting...';
            setTimeout(() => {
                document.getElementById('timerOutput').innerHTML = 'Timeout executed after 2 seconds!';
            }, 2000);
        }

        function demoSetInterval() {
            let count = 0;
            intervalId = setInterval(() => {
                count++;
                document.getElementById('timerOutput').innerHTML = `Interval count: ${count}`;
                if (count >= 5) clearInterval(intervalId);
            }, 1000);
        }

        function clearIntervalDemo() {
            if (intervalId) {
                clearInterval(intervalId);
                document.getElementById('timerOutput').innerHTML = 'Interval cleared!';
            }
        }

        // Promises
        function demoPromise() {
            const promise = new Promise((resolve, reject) => {
                setTimeout(() => {
                    const success = Math.random() > 0.5;
                    if (success) {
                        resolve('Promise resolved successfully!');
                    } else {
                        reject('Promise rejected!');
                    }
                }, 1000);
            });

            promise
                .then(result => {
                    document.getElementById('promiseOutput').innerHTML = result;
                })
                .catch(error => {
                    document.getElementById('promiseOutput').innerHTML = error;
                })
                .finally(() => {
                    console.log('Promise finished');
                });
        }

        function demoPromiseChain() {
            const promise1 = new Promise(resolve => setTimeout(() => resolve(1), 1000));
            const promise2 = new Promise(resolve => setTimeout(() => resolve(2), 1000));

            promise1
                .then(result1 => {
                    document.getElementById('promiseOutput').innerHTML = `First: ${result1}`;
                    return promise2;
                })
                .then(result2 => {
                    document.getElementById('promiseOutput').innerHTML += `<br>Second: ${result2}`;
                });
        }

        function demoPromiseAll() {
            const promises = [
                new Promise(resolve => setTimeout(() => resolve('A'), 1000)),
                new Promise(resolve => setTimeout(() => resolve('B'), 1500)),
                new Promise(resolve => setTimeout(() => resolve('C'), 500))
            ];

            Promise.all(promises)
                .then(results => {
                    document.getElementById('promiseOutput').innerHTML = `All resolved: ${results.join(', ')}`;
                })
                .catch(error => {
                    document.getElementById('promiseOutput').innerHTML = `Error: ${error}`;
                });
        }

        // Async/Await
        async function demoAsyncAwait() {
            try {
                document.getElementById('asyncOutput').innerHTML = 'Starting async operation...';
                const result = await new Promise(resolve => setTimeout(() => resolve('Async/Await completed!'), 2000));
                document.getElementById('asyncOutput').innerHTML = result;
            } catch (error) {
                document.getElementById('asyncOutput').innerHTML = `Error: ${error}`;
            }
        }

        // Fetch API
        async function demoFetch() {
            try {
                document.getElementById('fetchOutput').innerHTML = 'Fetching data...';
                const response = await fetch('https://jsonplaceholder.typicode.com/posts/1');
                if (!response.ok) throw new Error('Network response was not ok');
                const data = await response.json();
                document.getElementById('fetchOutput').innerHTML = `Title: ${data.title}<br>Body: ${data.body}`;
            } catch (error) {
                document.getElementById('fetchOutput').innerHTML = `Error: ${error.message}`;
            }
        }

        // File Loading
        function loadFile() {
            const file = document.getElementById('fileInput').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById('fileOutput').innerHTML = `File content:<br>${e.target.result}`;
                };
                reader.readAsText(file);
            }
        }

        // Callbacks
        function demoCallback() {
            function greet(name, callback) {
                setTimeout(() => {
                    callback(`Hello, ${name}!`);
                }, 1000);
            }

            greet('World', (message) => {
                document.getElementById('callbackOutput').innerHTML = message;
            });
        }

        // Event Listeners
        document.getElementById('eventButton').addEventListener('click', function () {
            document.getElementById('eventOutput').innerHTML = 'Event fired at ' + new Date().toLocaleTimeString();
        });

        // Web Workers
        function demoWebWorker() {
            if (typeof (Worker) !== "undefined") {
                const worker = new Worker(URL.createObjectURL(new Blob([`
                    onmessage = function(e) {
                        let result = 0;
                        for (let i = 0; i < 1000000; i++) {
                            result += i;
                        }
                        postMessage(result);
                    }
                `], { type: 'application/javascript' })));

                worker.onmessage = function (e) {
                    document.getElementById('workerOutput').innerHTML = 'Worker result: ' + e.data;
                    worker.terminate();
                };

                worker.postMessage('start');
            } else {
                document.getElementById('workerOutput').innerHTML = 'Web Workers not supported';
            }
        }

        // Explain functions
        function explainTimers() {
            showModal('Timers', 'Timers allow you to execute code after a delay (setTimeout) or repeatedly at intervals (setInterval). They are asynchronous and don\'t block the main thread.');
        }

        function explainPromises() {
            showModal('Promises', 'Promises represent the eventual completion or failure of an asynchronous operation. They have three states: pending, fulfilled, and rejected. Use .then() for success, .catch() for errors, and .finally() for cleanup.');
        }

        function explainAsyncAwait() {
            showModal('Async/Await', 'Async/await is syntactic sugar over promises. The async keyword makes a function return a promise, and await pauses execution until the promise resolves.');
        }

        function explainFetch() {
            showModal('Fetch API', 'The Fetch API provides an interface for fetching resources. It returns a promise that resolves to the Response object representing the response to the request.');
        }

        function explainFileLoading() {
            showModal('File Loading', 'FileReader API allows web applications to asynchronously read the contents of files stored on the user\'s computer.');
        }

        function explainCallbacks() {
            showModal('Callbacks', 'A callback is a function passed as an argument to another function, which is then invoked inside the outer function to complete some kind of routine or action.');
        }

        function explainEventListeners() {
            showModal('Event Listeners', 'Event listeners are functions that wait for a specific event to occur on an element, then execute code in response.');
        }

        function explainWebWorkers() {
            showModal('Web Workers', 'Web Workers allow you to run JavaScript in background threads, enabling concurrent execution without blocking the main thread.');
        }

        function showModal(title, content) {
            document.getElementById('modalTitle').innerHTML = title;
            document.getElementById('modalContent').innerHTML = content;
            document.getElementById('modal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }
    </script>
</body>

</html>